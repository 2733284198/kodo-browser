<div ng-include="'main/_/top.html'"></div>

<script type="text/ng-template" id="auth-endpoint-popup.html">
  <div>
    <ol style="padding-left:10px;">
      <li>{{'auth.eptpl.popup.msg1'|translate}}</li>
      <li>{{'auth.eptpl.popup.msg2'|translate}}<code>http://cn-east-1-s3.qiniu.com</code></li>
    </ol>
  </div>
</script>

<script type="text/ng-template" id="auth-region-popup.html">
  <div>
    <ol style="padding-left:10px;">
      <li>{{'auth.region.popup.msg1'|translate}}</li>
      <li>{{'auth.region.popup.msg2'|translate}}</li>
    </ol>
  </div>
</script>

<script type="text/ng-template" id="auth-remember-popup.html">
  <div>
    {{'auth.remember.popup.msg1'|translate}}
  </div>
</script>

<div style="overflow:auto;height:100%">

  <div class="clearfix" style="height:40px;"></div>

  <div class="col-sm-8 col-sm-offset-2">
    <div class="panel panel-default shadow10">

      <div class="panel-heading pd0" style="border:0">
        <ul class="nav nav-tabs">
          <li role="presentation" ng-class="{active:gtab==2}">
            <a href="" ng-click="gtab=2">
              {{'auth.passlogin'|translate}}
            </a>
          </li>
          <li role="presentation" ng-class="{active:gtab==1}">
            <a href="" ng-click="gtab=1">
              {{'auth.accessLogin'|translate}}
            </a>
          </li>
        </ul>
      </div>

      <div class="panel-body">

        <form ng-if="gtab==1" class="form-horizontal" name="form1" ng-submit="onSubmit(form1)">
          <div class="form-group" ng-if="regions && regions.length > 0">
            <label for="input4" class="col-sm-4 control-label">
              <span class="red">*</span>
              {{'region'|translate}}:
            </label>
            <div class="col-sm-8">
              <select required ng-model="item.servicetpl" class="form-control" id="input4" placeholder="{{'auth.region.placeholder'|translate}}" ng-options="rg.endpoint as ('region.'+rg.id|translate) for rg in regions"></select>
            </div>
          </div>

          <div class="form-group has-feedback" ng-class="{'has-error': !form1.aid.$valid }">
            <label for="aid" class="col-sm-4 control-label">
              <span class="red">*</span> AccessKeyId:</label>
            <div class="col-sm-8">
              <input type="text" required ng-model="item.id" class="form-control" id="aid" name="aid" placeholder="{{'auth.id.placeholder'|translate}}">
            </div>
          </div>
          <div class="form-group has-feedback" ng-class="{'has-error': !form1.akey.$valid }">
            <label for="akey" class="col-sm-4 control-label">
              <span class="red">*</span> AccessKeySecret:</label>
            <div class="col-sm-8">
              <input type="password" required ng-model="item.secret" class="form-control" id="akey" name="akey" placeholder="{{'auth.secret.placeholder'|translate}}">
            </div>
          </div>

          <div class="form-group">
            <div class="col-sm-offset-4 col-sm-8">
              <button type="submit" class="btn btn-primary">
                {{'auth.login'|translate}}
              </button>
            </div>
          </div>
        </form>

        <form ng-if="gtab==2" class="form-horizontal" name="form2" ng-submit="onSubmitPass(form2)">
          <div class="form-group has-feedback" ng-class="{'has-error': !form2.auser.$valid }">
            <label for="auser" class="col-sm-4 control-label">
              <span class="red">*</span> {{'auth.username'|translate}}:
            </label>
            <div class="col-sm-8">
              <div class="input-group">
                <input type="text" required ng-model="item.username" class="form-control" id="auser" name="auser" placeholder="{{'auth.username.placeholder'|translate}}">
                <span class="input-group-addon">{{ item.domain }}</span>
              </div>
            </div>
          </div>
          <div class="form-group has-feedback" ng-class="{'has-error': !form2.apass.$valid }">
            <label for="apass" class="col-sm-4 control-label">
              <span class="red">*</span> {{'auth.password'|translate}}:
            </label>
            <div class="col-sm-8">
              <input type="password" required ng-model="item.password" class="form-control" id="apass" name="apass" placeholder="{{'auth.password.placeholder'|translate}}">
            </div>
          </div>

          <fieldset class="login-fieldset">
            <legend>
              <input type="checkbox" ng-model="flags.showMore" ng-true-value="1" ng-false-value="0" /> {{'auth.settings'|translate}}
            </legend>
            <div ng-if="flags.showMore == 1" class="form-group has-feedback" ng-class="{'has-error':!form2.logintpl.$valid}">
              <label for="logintpl" class="col-sm-4 control-label">
                <span class="red">*</span> {{'auth.logintpl'|translate}}:
              </label>

              <div class="col-sm-8">
                <input type="text" required ng-model="item.logintpl" ng-pattern="/^http(s)?\:\/\//" class="form-control" id="logintpl" name="logintpl" placeholder="https://">
              </div>
            </div>

            <div ng-if="flags.showMore == 1" class="form-group has-feedback" ng-class="{'has-error':!form2.servicetpl.$valid}">
              <label for="servicetpl" class="col-sm-4 control-label">
                <span class="red">*</span> {{'auth.servicetpl'|translate}}:
              </label>

              <div class="col-sm-8">
                <input type="text" required ng-model="item.servicetpl" ng-pattern="/^http(s)?\:\/\//" class="form-control" id="servicetpl" name="servicetpl" placeholder="https://">
              </div>
            </div>
          </fieldset>

          <div class="form-group">
            <div class="col-sm-offset-4 col-sm-9">
              <button type="submit" class="btn btn-primary">
                {{'auth.login'|translate}}
              </button>
            </div>
          </div>
        </form>

      </div>
    </div>
  </div>

  <div class="clearfix"></div>

  <div ng-if="gtab==1" class="col-xs-12" ng-show="flags.showHis=='YES'">
    <header>
      <h4 class="col-xs-6">
        {{'auth.akHistories'|translate}}
        <!-- AK历史 -->
      </h4>
      <div class="col-xs-6">
        <a href="" ng-click="showCleanHistories()" class="pull-right text-danger" style="padding-top:10px;">
          {{'auth.clearHistories'|translate}}
          <!-- 清空历史 -->
        </a>
      </div>
    </header>
    <table class="table table-condensed table-striped table-bordered">
      <tr>
        <th>-</th>
        <th>ID</th>
        <th>Secret</th>
        <th>{{'auth.description'|translate}}</th>
        <th>{{'actions'|translate}}</th>
      </tr>
      <tr ng-repeat="h in his">
        <td>{{$index+1}}</td>
        <td>{{h.id}}</td>
        <td>{{h.secret|hideSecret}}</td>
        <td>{{h.desc}}</td>
        <td>
          <a href="" ng-click="useHis(h)">{{'use'|translate}}</a> |
          <a href="" ng-click="showRemoveHis(h)" class="text-danger">{{'delete'|translate}}</a>
        </td>
      </tr>
    </table>
  </div>

</div>